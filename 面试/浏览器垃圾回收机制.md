# 垃圾回收机制

- 目的

  - 防止页面占用内存过大 引起客户端卡顿 或是无响应
  - Node.js 使用V8引擎 内存对后端服务的性能至关重要（因为后端的服务的持久性 容易造成内存溢出

- JS的内存机制

  - 八种数据类型（String Number Boolean Null Undefined Symbol Bigint Object）
  - 原值数据类型保存在栈内存 堆内存保存引用数据类型（Object）

- 每个函数都有自己的执行环境 当执行流进入函数时 函数的环境推入一个环境栈中 当函数执行完后  栈将环境弹出 把控制权返回之前的执行环境（基于这个原理 对内存上采取标记清除

- V8回收策略

  - 分代回收策略 将内存分成新生代和老生代 对新老生代采取不同的回收策略

  - 新生代

    - ![image-20220127105752165](C:\Users\pc\AppData\Roaming\Typora\typora-user-images\image-20220127105752165.png)
    - from作为清除
    - 在From空间和To空间反转的过程中 如果To空间的使用量超过25% 将From的空间的对象直接晋升长老生代

  - 老生代

    - 老生代内存空间是一个连续的结构

    - 标记清除

      - 将需要回收的对象进行标记 在垃圾回收时直接释放

    - 标记合并

      - 将需要回收对象移动在一边 存活的对象移动到另一边 然后对需要被回收的额对象区域进行整体的垃圾回收

        